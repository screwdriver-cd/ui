<BsNavbar as |navbar|>
  <div class="navbar-header">
    {{navbar.toggle}}
    <LinkTo @route="home" class="logo navbar-brand" @title="Screwdriver Home">
      {{inline-svg "Screwdriver_Logo_FullWhite" class="img"}}
    </LinkTo>
  </div>
  <navbar.content>
    <navbar.nav @classNames="navbar-nav navbar-left" as |nav|>
      <nav.item>
        <LinkTo @route="home" class="icon">
          <span>
            Collections
          </span>
        </LinkTo>
      </nav.item>
      <nav.item>
        <nav.dropdown as |dd|>
          <dd.toggle class="icon tools">
            <span>
              Tools
            </span>
            <span class="caret"></span>
          </dd.toggle>
          <dd.menu as |ddm|>
            <ddm.item>
              <LinkTo @route="validator" @classNames="icon validator">
                <span>
                  Validator
                </span>
              </LinkTo>
            </ddm.item>
            <ddm.item>
              <LinkTo @route="templates" @classNames="icon templates">
                <span>
                  Templates
                </span>
              </LinkTo>
            </ddm.item>
            <ddm.item>
              <LinkTo @route="commands" @classNames="icon commands">
                <span>
                  Commands
                </span>
              </LinkTo>
            </ddm.item>
            <ddm.item>
              <LinkTo
                @route="pipeline-visualizer"
                @classNames="icon pipeline-visualizer"
              >
                <span>
                  Visualizer
                </span>
              </LinkTo>
            </ddm.item>
          </dd.menu>
        </nav.dropdown>
      </nav.item>
      {{#if session.isAuthenticated}}
        <nav.item>
          <a class="icon create" onclick={{action "openCreatePipeline"}}>
            {{inline-svg "add-circle" class="img"}}
            <span>
              Create Pipeline
            </span>
          </a>
        </nav.item>
      {{/if}}
    </navbar.nav>

    <navbar.nav @classNames="navbar-nav navbar-right" as |nav|>
      {{#if showSearch}}
        <nav.item>
          <form class="navbar-form navbar-right" role="search">
            <Input
              class="search-input"
              @name="query"
              placeholder="Search Screwdriver pipelines"
              @enter={{action "triggerSearch"}}
              @escape-press={{action "cancelSearch"}}
              @autofocus="true"
              @value={{searchTerm}}
            />
            <button class="search-button" {{action "triggerSearch"}}>
              <FaIcon @icon="search" @title="Search" />
            </button>
          </form>
        </nav.item>
      {{else}}
        <nav.item>
          <a
            href="#"
            class="icon search"
            title="Search"
            {{action (mut showSearch) (not showSearch) preventDefault=false}}
          >
            {{inline-svg "search" class="img"}}
          </a>
        </nav.item>
      {{/if}}

      <nav.item>
        <nav.dropdown as |dd|>
          <dd.toggle class="icon docs-outline">
            {{inline-svg "help-circle" class="img"}}
          </dd.toggle>
          <dd.menu as |ddm|>
            <ddm.item>
              <a
                href={{docUrl}}
                class="icon docs"
                title="Documentation and Contact"
              >
                {{inline-svg "file-text" class="img"}}<span>
                  Documentation
                </span>
              </a>
            </ddm.item>
            <ddm.item>
              <a class="release">
                <FaIcon @icon="tag" /><span>
                  {{releaseVersion}}
                </span>
              </a>
            </ddm.item>
            {{ddm.divider}}
            <ddm.item>
              <a href="http://blog.screwdriver.cd" class="icon blog">
                {{inline-svg "tumblr" class="img"}}<span>
                  Blog
                </span>
              </a>
            </ddm.item>
            <ddm.item>
              <a href={{slackUrl}} class="icon community">
                {{inline-svg "slack" class="img"}}<span>
                  Slack Workspace
                </span>
              </a>
            </ddm.item>
            <ddm.item>
              <a href="https://github.com/screwdriver-cd" class="icon github">
                {{inline-svg "github" class="img"}}<span>
                  GitHub
                </span>
              </a>
            </ddm.item>
          </dd.menu>
        </nav.dropdown>
      </nav.item>
      <nav.item>
        {{#if session.isAuthenticated}}
          <nav.dropdown as |dd|>
            <dd.toggle class="icon profile-outline">
              {{inline-svg "profile-outline" class="img"}}
              <span class="icontitle">
                {{session.data.authenticated.username}}
              </span>
              <span class="caret"></span>
            </dd.toggle>
            <dd.menu as |ddm|>
              <ddm.item>
                <span class="title">
                  ACCOUNTS
                </span>
              </ddm.item>
              {{#each scmContexts as |scmContext|}}
                {{#unless scmContext.readOnly}}
                  <ddm.item>
                    {{#if scmContext.isSignedIn}}
                      <a class="active">
                        <FaIcon @icon={{scmContext.iconType}} @prefix="fab" /> {{scmContext.displayName
                        }}
                        <span>
                          active
                        </span>
                      </a>
                    {{else}}
                      <a
                        href="#authenticate"
                        {{action "authenticate" scmContext.context}}
                      >
                        <FaIcon @icon={{scmContext.iconType}} @prefix="fab" /> {{scmContext.displayName
                        }}
                      </a>
                    {{/if}}
                  </ddm.item>
                {{/unless}}
              {{/each}}
              {{ddm.divider}}
              {{#if (not session.data.authenticated.isGuest)}}
                <ddm.item>
                  <LinkTo @route="user-settings" @title="User Settings">
                    User Settings
                  </LinkTo>
                </ddm.item>
              {{/if}}
              <ddm.item>
                <a
                  href="#signout"
                  class="logout"
                  title="Sign out of Screwdriver"
                  {{action "invalidateSession"}}
                >
                  Sign out
                </a>
              </ddm.item>
            </dd.menu>
          </nav.dropdown>
        {{else}}
          <LinkTo
            @route="login"
            @query={{hash fromUrl=currentUrl}}
            @title="Sign in to Screwdriver"
            class="icon profile-outline"
          >
            {{inline-svg "profile-outline" class="img"}}
            <span class="icontitle">
              Sign in
            </span>
          </LinkTo>
        {{/if}}
      </nav.item>
    </navbar.nav>
  </navbar.content>
</BsNavbar>

<div class="tooltips">
  {{#if session.isAuthenticated}}
    <BsTooltip
      @placement="bottom"
      @triggerElement=".icon.create"
      @renderInPlace={{true}}
    >
      Create a new Pipeline
    </BsTooltip>
  {{/if}}
  {{#if session.isAuthenticated}}
    {{#each scmContexts as |scmContext|}}
      {{#if scmContext.isSignedIn}}
        <BsTooltip
          @placement="bottom"
          @triggerElement=".icon.profile-outline"
          @triggerEvents="hover"
          @renderInPlace={{true}}
        >
          Currently signed in to a {{scmContext.displayName}} account.
        </BsTooltip>
      {{/if}}
    {{/each}}
  {{else}}
    <BsTooltip
      @placement="bottom"
      @triggerElement=".icon.profile-outline"
      @renderInPlace={{true}}
    >
      Sign in to Screwdriver
    </BsTooltip>
  {{/if}}
</div>